{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/mtrce/portal-test/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/mtrce/portal-test/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mtrce/portal-test/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import ErrorPage from'../PageNotFound/ErrorPage';import{getFormById}from'./formapi';import{segments}from'./renderSegmentContent';import{renderSegmentContent}from'./renderSegmentContent';import{initialFormState,handleFormChange,saveForm,handleDragOver}from'./pqc_utils';import{addRow,handleInputChange,handleDrop,handleFileSelect}from'./rowDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FormEdit=function FormEdit(){var _form$product,_form$vendor;var _useParams=useParams(),id=_useParams.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),activeSegment=_useState4[0],setActiveSegment=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),finalRows=_useState6[0],setFinalRows=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),subpartRows=_useState8[0],setSubpartRows=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var addFinalRow=addRow(finalRows,setFinalRows);var handleFinalInputChange=handleInputChange(finalRows,setFinalRows);var handleFinalDrop=handleDrop(finalRows,setFinalRows);var handleFinalFileSelect=handleFileSelect(finalRows,setFinalRows);var addSubpartRow=addRow(subpartRows,setSubpartRows);var handleSubpartInputChange=handleInputChange(subpartRows,setSubpartRows);var handleSubpartDrop=handleDrop(subpartRows,setSubpartRows);var handleSubpartFileSelect=handleFileSelect(subpartRows,setSubpartRows);useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var formData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getFormById(id);case 3:formData=_context.sent;console.log(\"Fetched form data: \",formData);// Log the fetched form data\nsetForm(formData);_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error(\"Error fetching form: \",_context.t0);// Log the error if there is one\nsetError(true);case 12:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[id]);useEffect(function(){if(form){var activeStep=form.steps.find(function(step){return step.name===segments[activeSegment-1].name;});console.log(\"Active step: \",activeStep);// Log the active step\nif(activeStep&&activeStep.substeps){// Here you should separate rows into finalRows and subpartRows based on some condition\nconsole.log(\"Active step substeps: \",activeStep.substeps);// Log substeps before setting\nsetFinalRows(activeStep.substeps||[]);setSubpartRows(activeStep.substeps||[]);}}},[form,activeSegment]);var handleSegmentClick=function handleSegmentClick(order){setActiveSegment(order);};if(error){return/*#__PURE__*/_jsx(ErrorPage,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"form-edit-main\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"ITP Formu\"}),form?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Product Name: \",form.product_name||((_form$product=form.product)===null||_form$product===void 0?void 0:_form$product.name)]}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Vendor Name: \",form.vendor_name||((_form$vendor=form.vendor)===null||_form$vendor===void 0?void 0:_form$vendor.name)]}),/*#__PURE__*/_jsx(\"div\",{className:\"segments\",children:segments.map(function(segment){return/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleSegmentClick(segment.order);},className:activeSegment===segment.order?'active':'',children:segment.name},segment.order);})}),/*#__PURE__*/_jsx(\"div\",{className:\"segment-content\",children:renderSegmentContent({activeSegment:activeSegment,form:form,finalRows:finalRows,subpartRows:subpartRows,handleFinalInputChange:handleFinalInputChange,handleSubpartInputChange:handleSubpartInputChange,handleDragOver:handleDragOver,handleFinalDrop:handleFinalDrop,handleSubpartDrop:handleSubpartDrop,handleFinalFileSelect:handleFinalFileSelect,handleSubpartFileSelect:handleSubpartFileSelect,addFinalRow:addFinalRow,addSubpartRow:addSubpartRow,saveSubForm:saveForm(form,subpartRows,0),saveFinalForm:saveForm(form,finalRows,1)})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Form y\\xFCkleniyor...\"})]});};export default FormEdit;","map":{"version":3,"names":["React","useState","useEffect","useParams","ErrorPage","getFormById","segments","renderSegmentContent","initialFormState","handleFormChange","saveForm","handleDragOver","addRow","handleInputChange","handleDrop","handleFileSelect","jsx","_jsx","jsxs","_jsxs","FormEdit","_form$product","_form$vendor","_useParams","id","_useState","_useState2","_slicedToArray","form","setForm","_useState3","_useState4","activeSegment","setActiveSegment","_useState5","_useState6","finalRows","setFinalRows","_useState7","_useState8","subpartRows","setSubpartRows","_useState9","_useState10","error","setError","addFinalRow","handleFinalInputChange","handleFinalDrop","handleFinalFileSelect","addSubpartRow","handleSubpartInputChange","handleSubpartDrop","handleSubpartFileSelect","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","formData","wrap","_callee$","_context","prev","next","sent","console","log","t0","stop","apply","arguments","activeStep","steps","find","step","name","substeps","handleSegmentClick","order","className","children","product_name","product","vendor_name","vendor","map","segment","onClick","saveSubForm","saveFinalForm"],"sources":["C:/Users/mtrce/portal-test/client/src/components/PQC/editForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport ErrorPage from '../PageNotFound/ErrorPage';\r\nimport { getFormById } from './formapi';\r\nimport { segments } from './renderSegmentContent';\r\nimport { renderSegmentContent } from './renderSegmentContent';\r\nimport { initialFormState, handleFormChange, saveForm, handleDragOver } from './pqc_utils';\r\nimport { addRow, handleInputChange, handleDrop, handleFileSelect } from './rowDetail';\r\n\r\nconst FormEdit = () => {\r\n  const { id } = useParams();\r\n  const [form, setForm] = useState(null);\r\n  const [activeSegment, setActiveSegment] = useState(1);\r\n  const [finalRows, setFinalRows] = useState([]);\r\n  const [subpartRows, setSubpartRows] = useState([]);\r\n  const [error, setError] = useState(false);\r\n\r\n  const addFinalRow = addRow(finalRows, setFinalRows);\r\n  const handleFinalInputChange = handleInputChange(finalRows, setFinalRows);\r\n  const handleFinalDrop = handleDrop(finalRows, setFinalRows);\r\n  const handleFinalFileSelect = handleFileSelect(finalRows, setFinalRows);\r\n\r\n  const addSubpartRow = addRow(subpartRows, setSubpartRows);\r\n  const handleSubpartInputChange = handleInputChange(subpartRows, setSubpartRows);\r\n  const handleSubpartDrop = handleDrop(subpartRows, setSubpartRows);\r\n  const handleSubpartFileSelect = handleFileSelect(subpartRows, setSubpartRows);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const formData = await getFormById(id);\r\n        console.log(\"Fetched form data: \", formData);  // Log the fetched form data\r\n        setForm(formData);\r\n      } catch (error) {\r\n        console.error(\"Error fetching form: \", error);  // Log the error if there is one\r\n        setError(true);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    if (form) {\r\n      const activeStep = form.steps.find(\r\n        (step) => step.name === segments[activeSegment - 1].name\r\n      );\r\n      console.log(\"Active step: \", activeStep);  // Log the active step\r\n      if (activeStep && activeStep.substeps) {\r\n        // Here you should separate rows into finalRows and subpartRows based on some condition\r\n        console.log(\"Active step substeps: \", activeStep.substeps);  // Log substeps before setting\r\n        setFinalRows(activeStep.substeps || []);\r\n        setSubpartRows(activeStep.substeps || []);\r\n      }\r\n    }\r\n}, [form, activeSegment]);\r\n\r\n\r\n  const handleSegmentClick = (order) => {\r\n    setActiveSegment(order);\r\n  };\r\n\r\n  if (error) {\r\n    return <ErrorPage />;\r\n  }\r\n\r\n  return (\r\n    <div className='form-edit-main'>\r\n      <h1>ITP Formu</h1>\r\n      {form ? (\r\n        <div>\r\n          <h2>Product Name: {form.product_name || form.product?.name}</h2>\r\n          <h2>Vendor Name: {form.vendor_name || form.vendor?.name}</h2>\r\n          <div className=\"segments\">\r\n            {segments.map((segment) => (\r\n              <button key={segment.order} onClick={() => handleSegmentClick(segment.order)} className={activeSegment === segment.order ? 'active' : ''} >\r\n                {segment.name}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <div className=\"segment-content\">\r\n            {renderSegmentContent({\r\n              activeSegment,\r\n              form,\r\n              finalRows,\r\n              subpartRows,\r\n              handleFinalInputChange,\r\n              handleSubpartInputChange,\r\n              handleDragOver,\r\n              handleFinalDrop,\r\n              handleSubpartDrop,\r\n              handleFinalFileSelect,\r\n              handleSubpartFileSelect,\r\n              addFinalRow,\r\n              addSubpartRow,\r\n              saveSubForm: saveForm(form, subpartRows, 0),\r\n              saveFinalForm: saveForm(form, finalRows, 1),\r\n            })}\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <p>Form yükleniyor...</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FormEdit;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}