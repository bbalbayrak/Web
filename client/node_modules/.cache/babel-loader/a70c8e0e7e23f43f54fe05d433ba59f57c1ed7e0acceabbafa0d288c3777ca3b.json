{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/mtrce/portal-test/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/mtrce/portal-test/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/mtrce/portal-test/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import ErrorPage from'../PageNotFound/ErrorPage';import{getFormById}from'./formapi';import{segments}from'./renderSegmentContent';import{renderSegmentContent}from'./renderSegmentContent';import{initialFormState,fetchItems,handleFormChange,saveForm,handleDragOver}from'./pqc_utils';import{addRow,handleInputChange,handleDrop,handleFileSelect}from'./rowDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FormEdit=function FormEdit(){var _form$product,_form$vendor;var _useParams=useParams(),id=_useParams.id;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),activeSegment=_useState4[0],setActiveSegment=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),formSaved=_useState6[0],setFormSaved=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),rows=_useState8[0],setRows=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var formData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getFormById(id);case 3:formData=_context.sent;setForm(formData);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);setError(true);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[id]);useEffect(function(){if(formSaved){var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var formData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return getFormById(id);case 3:formData=_context2.sent;setForm(formData);setFormSaved(false);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);setError(true);case 11:case\"end\":return _context2.stop();}},_callee2,null,[[0,8]]);}));return function fetchData(){return _ref2.apply(this,arguments);};}();fetchData();}},[formSaved,id]);useEffect(function(){if(form){var finalPartMeasurementStep=form.steps.find(function(step){return step.name==='Final Part Measurement';});if(finalPartMeasurementStep){setRows(finalPartMeasurementStep.substeps);}}},[form]);var handleSegmentClick=function handleSegmentClick(order){setActiveSegment(order);};if(error){return/*#__PURE__*/_jsx(ErrorPage,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"form-edit-main\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"ITP Formu\"}),form?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Product Name: \",form.product_name||((_form$product=form.product)===null||_form$product===void 0?void 0:_form$product.name)]}),/*#__PURE__*/_jsxs(\"h2\",{children:[\"Vendor Name: \",form.vendor_name||((_form$vendor=form.vendor)===null||_form$vendor===void 0?void 0:_form$vendor.name)]}),/*#__PURE__*/_jsx(\"div\",{className:\"segments\",children:segments.map(function(segment){return/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleSegmentClick(segment.order);},className:activeSegment===segment.order?'active':'',children:segment.name},segment.order);})}),/*#__PURE__*/_jsx(\"div\",{className:\"segment-content\",children:renderSegmentContent({activeSegment:activeSegment,form:form,rows:rows.sort(function(a,b){return parseInt(a.row_number,10)-parseInt(b.row_number,10);}),// sort rows just before they are rendered\nhandleInputChange:handleInputChange(rows,setRows),handleDragOver:handleDragOver,handleDrop:handleDrop(rows,setRows),handleFileSelect:handleFileSelect(rows,setRows),addRow:addRow(rows,setRows),saveForm:saveForm(form,rows)})})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Form y\\xFCkleniyor...\"})]});};export default FormEdit;","map":{"version":3,"names":["React","useState","useEffect","useParams","ErrorPage","getFormById","segments","renderSegmentContent","initialFormState","fetchItems","handleFormChange","saveForm","handleDragOver","addRow","handleInputChange","handleDrop","handleFileSelect","jsx","_jsx","jsxs","_jsxs","FormEdit","_form$product","_form$vendor","_useParams","id","_useState","_useState2","_slicedToArray","form","setForm","_useState3","_useState4","activeSegment","setActiveSegment","_useState5","_useState6","formSaved","setFormSaved","_useState7","_useState8","rows","setRows","_useState9","_useState10","error","setError","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","formData","wrap","_callee$","_context","prev","next","sent","t0","stop","apply","arguments","_ref2","_callee2","_callee2$","_context2","finalPartMeasurementStep","steps","find","step","name","substeps","handleSegmentClick","order","className","children","product_name","product","vendor_name","vendor","map","segment","onClick","sort","a","b","parseInt","row_number"],"sources":["C:/Users/mtrce/portal-test/client/src/components/PQC/editForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport ErrorPage from '../PageNotFound/ErrorPage';\r\nimport { getFormById } from './formapi';\r\nimport { segments } from './renderSegmentContent';\r\nimport { renderSegmentContent } from './renderSegmentContent';\r\nimport { initialFormState, fetchItems, handleFormChange, saveForm, handleDragOver } from './pqc_utils';\r\nimport { addRow, handleInputChange, handleDrop, handleFileSelect } from './rowDetail';\r\n\r\nconst FormEdit = () => {\r\n  const { id } = useParams();\r\n  const [form, setForm] = useState(null);\r\n  const [activeSegment, setActiveSegment] = useState(1);\r\n  const [formSaved, setFormSaved] = useState(false);\r\n  const [rows, setRows] = useState([]);\r\n  const [error, setError] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const formData = await getFormById(id);\r\n        setForm(formData);\r\n      } catch (error) {\r\n        setError(true);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [id]);\r\n  \r\n  useEffect(() => {\r\n    if (formSaved) {\r\n      const fetchData = async () => {\r\n        try {\r\n          const formData = await getFormById(id);\r\n          setForm(formData);\r\n          setFormSaved(false);\r\n        } catch (error) {\r\n          setError(true);\r\n        }\r\n      };\r\n      fetchData();\r\n    }\r\n  }, [formSaved, id]);\r\n  \r\n  useEffect(() => {\r\n    if (form) {\r\n      const finalPartMeasurementStep = form.steps.find(\r\n        (step) => step.name === 'Final Part Measurement'\r\n      );\r\n      if (finalPartMeasurementStep) {\r\n        setRows(finalPartMeasurementStep.substeps);\r\n      }\r\n    }\r\n  }, [form]);\r\n\r\n  const handleSegmentClick = (order) => {\r\n    setActiveSegment(order);\r\n  };\r\n\r\n  if (error) {\r\n    return <ErrorPage />;\r\n  }\r\n\r\n  return (\r\n    <div className='form-edit-main'>\r\n      <h1>ITP Formu</h1>\r\n      {form ? (\r\n        <div>\r\n          <h2>Product Name: {form.product_name || form.product?.name}</h2>\r\n          <h2>Vendor Name: {form.vendor_name || form.vendor?.name}</h2>\r\n          <div className=\"segments\">\r\n            {segments.map((segment) => (\r\n              <button key={segment.order} onClick={() => handleSegmentClick(segment.order)} className={activeSegment === segment.order ? 'active' : ''} >\r\n                {segment.name}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <div className=\"segment-content\">\r\n            {renderSegmentContent({\r\n              activeSegment,\r\n              form,\r\n              rows: rows.sort((a, b) => parseInt(a.row_number, 10) - parseInt(b.row_number, 10)), // sort rows just before they are rendered\r\n              handleInputChange: handleInputChange(rows, setRows),\r\n              handleDragOver,\r\n              handleDrop: handleDrop(rows, setRows),\r\n              handleFileSelect: handleFileSelect(rows, setRows),\r\n              addRow: addRow(rows, setRows),\r\n              saveForm: saveForm(form, rows),\r\n            })}\r\n          </div>\r\n        </div>\r\n      ) : (\r\n        <p>Form y√ºkleniyor...</p>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FormEdit;\r\n"],"mappings":"qXAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,MAAO,CAAAC,SAAS,KAAM,2BAA2B,CACjD,OAASC,WAAW,KAAQ,WAAW,CACvC,OAASC,QAAQ,KAAQ,wBAAwB,CACjD,OAASC,oBAAoB,KAAQ,wBAAwB,CAC7D,OAASC,gBAAgB,CAAEC,UAAU,CAAEC,gBAAgB,CAAEC,QAAQ,CAAEC,cAAc,KAAQ,aAAa,CACtG,OAASC,MAAM,CAAEC,iBAAiB,CAAEC,UAAU,CAAEC,gBAAgB,KAAQ,aAAa,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEtF,GAAM,CAAAC,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAA,CAAS,KAAAC,aAAA,CAAAC,YAAA,CACrB,IAAAC,UAAA,CAAerB,SAAS,EAAE,CAAlBsB,EAAE,CAAAD,UAAA,CAAFC,EAAE,CACV,IAAAC,SAAA,CAAwBzB,QAAQ,CAAC,IAAI,CAAC,CAAA0B,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA/BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,IAAAI,UAAA,CAA0C9B,QAAQ,CAAC,CAAC,CAAC,CAAA+B,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA9CE,aAAa,CAAAD,UAAA,IAAEE,gBAAgB,CAAAF,UAAA,IACtC,IAAAG,UAAA,CAAkClC,QAAQ,CAAC,KAAK,CAAC,CAAAmC,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAA1CE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAC9B,IAAAG,UAAA,CAAwBtC,QAAQ,CAAC,EAAE,CAAC,CAAAuC,UAAA,CAAAZ,cAAA,CAAAW,UAAA,IAA7BE,IAAI,CAAAD,UAAA,IAAEE,OAAO,CAAAF,UAAA,IACpB,IAAAG,UAAA,CAA0B1C,QAAQ,CAAC,KAAK,CAAC,CAAA2C,WAAA,CAAAhB,cAAA,CAAAe,UAAA,IAAlCE,KAAK,CAAAD,WAAA,IAAEE,QAAQ,CAAAF,WAAA,IAEtB1C,SAAS,CAAC,UAAM,CACd,GAAM,CAAA6C,SAAS,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,QAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAES,CAAArD,WAAW,CAACoB,EAAE,CAAC,QAAhC4B,QAAQ,CAAAG,QAAA,CAAAG,IAAA,CACd7B,OAAO,CAACuB,QAAQ,CAAC,CAACG,QAAA,CAAAE,IAAA,iBAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAI,EAAA,CAAAJ,QAAA,aAElBV,QAAQ,CAAC,IAAI,CAAC,CAAC,yBAAAU,QAAA,CAAAK,IAAA,MAAAT,OAAA,gBAElB,kBAPK,CAAAL,SAASA,CAAA,SAAAC,IAAA,CAAAc,KAAA,MAAAC,SAAA,OAOd,CACDhB,SAAS,EAAE,CACb,CAAC,CAAE,CAACtB,EAAE,CAAC,CAAC,CAERvB,SAAS,CAAC,UAAM,CACd,GAAImC,SAAS,CAAE,CACb,GAAM,CAAAU,SAAS,6BAAAiB,KAAA,CAAAf,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAc,SAAA,MAAAZ,QAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAY,UAAAC,SAAA,iBAAAA,SAAA,CAAAV,IAAA,CAAAU,SAAA,CAAAT,IAAA,SAAAS,SAAA,CAAAV,IAAA,GAAAU,SAAA,CAAAT,IAAA,SAES,CAAArD,WAAW,CAACoB,EAAE,CAAC,QAAhC4B,QAAQ,CAAAc,SAAA,CAAAR,IAAA,CACd7B,OAAO,CAACuB,QAAQ,CAAC,CACjBf,YAAY,CAAC,KAAK,CAAC,CAAC6B,SAAA,CAAAT,IAAA,iBAAAS,SAAA,CAAAV,IAAA,GAAAU,SAAA,CAAAP,EAAA,CAAAO,SAAA,aAEpBrB,QAAQ,CAAC,IAAI,CAAC,CAAC,yBAAAqB,SAAA,CAAAN,IAAA,MAAAI,QAAA,gBAElB,kBARK,CAAAlB,SAASA,CAAA,SAAAiB,KAAA,CAAAF,KAAA,MAAAC,SAAA,OAQd,CACDhB,SAAS,EAAE,CACb,CACF,CAAC,CAAE,CAACV,SAAS,CAAEZ,EAAE,CAAC,CAAC,CAEnBvB,SAAS,CAAC,UAAM,CACd,GAAI2B,IAAI,CAAE,CACR,GAAM,CAAAuC,wBAAwB,CAAGvC,IAAI,CAACwC,KAAK,CAACC,IAAI,CAC9C,SAACC,IAAI,QAAK,CAAAA,IAAI,CAACC,IAAI,GAAK,wBAAwB,GACjD,CACD,GAAIJ,wBAAwB,CAAE,CAC5B1B,OAAO,CAAC0B,wBAAwB,CAACK,QAAQ,CAAC,CAC5C,CACF,CACF,CAAC,CAAE,CAAC5C,IAAI,CAAC,CAAC,CAEV,GAAM,CAAA6C,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAAIC,KAAK,CAAK,CACpCzC,gBAAgB,CAACyC,KAAK,CAAC,CACzB,CAAC,CAED,GAAI9B,KAAK,CAAE,CACT,mBAAO3B,IAAA,CAACd,SAAS,IAAG,CACtB,CAEA,mBACEgB,KAAA,QAAKwD,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7B3D,IAAA,OAAA2D,QAAA,CAAI,WAAS,EAAK,CACjBhD,IAAI,cACHT,KAAA,QAAAyD,QAAA,eACEzD,KAAA,OAAAyD,QAAA,EAAI,gBAAc,CAAChD,IAAI,CAACiD,YAAY,IAAAxD,aAAA,CAAIO,IAAI,CAACkD,OAAO,UAAAzD,aAAA,iBAAZA,aAAA,CAAckD,IAAI,IAAM,cAChEpD,KAAA,OAAAyD,QAAA,EAAI,eAAa,CAAChD,IAAI,CAACmD,WAAW,IAAAzD,YAAA,CAAIM,IAAI,CAACoD,MAAM,UAAA1D,YAAA,iBAAXA,YAAA,CAAaiD,IAAI,IAAM,cAC7DtD,IAAA,QAAK0D,SAAS,CAAC,UAAU,CAAAC,QAAA,CACtBvE,QAAQ,CAAC4E,GAAG,CAAC,SAACC,OAAO,qBACpBjE,IAAA,WAA4BkE,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAAV,kBAAkB,CAACS,OAAO,CAACR,KAAK,CAAC,EAAC,CAACC,SAAS,CAAE3C,aAAa,GAAKkD,OAAO,CAACR,KAAK,CAAG,QAAQ,CAAG,EAAG,CAAAE,QAAA,CACtIM,OAAO,CAACX,IAAI,EADFW,OAAO,CAACR,KAAK,CAEjB,EACV,CAAC,EACE,cACNzD,IAAA,QAAK0D,SAAS,CAAC,iBAAiB,CAAAC,QAAA,CAC7BtE,oBAAoB,CAAC,CACpB0B,aAAa,CAAbA,aAAa,CACbJ,IAAI,CAAJA,IAAI,CACJY,IAAI,CAAEA,IAAI,CAAC4C,IAAI,CAAC,SAACC,CAAC,CAAEC,CAAC,QAAK,CAAAC,QAAQ,CAACF,CAAC,CAACG,UAAU,CAAE,EAAE,CAAC,CAAGD,QAAQ,CAACD,CAAC,CAACE,UAAU,CAAE,EAAE,CAAC,GAAC,CAAE;AACpF3E,iBAAiB,CAAEA,iBAAiB,CAAC2B,IAAI,CAAEC,OAAO,CAAC,CACnD9B,cAAc,CAAdA,cAAc,CACdG,UAAU,CAAEA,UAAU,CAAC0B,IAAI,CAAEC,OAAO,CAAC,CACrC1B,gBAAgB,CAAEA,gBAAgB,CAACyB,IAAI,CAAEC,OAAO,CAAC,CACjD7B,MAAM,CAAEA,MAAM,CAAC4B,IAAI,CAAEC,OAAO,CAAC,CAC7B/B,QAAQ,CAAEA,QAAQ,CAACkB,IAAI,CAAEY,IAAI,CAC/B,CAAC,CAAC,EACE,GACF,cAENvB,IAAA,MAAA2D,QAAA,CAAG,uBAAkB,EACtB,GACG,CAEV,CAAC,CAED,cAAe,CAAAxD,QAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}